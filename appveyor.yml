image: Visual Studio 2017

platform: x64

configuration:
  - Debug
  - Release

install:
  - nuget restore
  - mkdir PlayspaceMover\third-party
  - git clone --depth 1 https://github.com/ValveSoftware/openvr PlayspaceMover\third-party\openvr
  - appveyor DownloadFile https://github.com/ValveSoftware/openvr/archive/v1.0.15.zip -FileName openvr-1.0.15.tar.gz
  - 7z x openvr-1.0.15.tar.gz -oPlayspaceMover\third-party\openvr
  - appveyor DownloadFile https://github.com/g-truc/glm/archive/0.9.9-a2.zip -FileName glm-0.9.9-a2.tar.gz
  - 7z x glm-0.9.9-a2.tar.gz -oPlayspaceMover\third-party\glm-0.9.9-a2
  - dir /s PlayspaceMover\third-party\glm-0.9.9-a2
  - git clone --depth 1 --branch 0.9.9-a2 https://github.com/g-truc/glm PlayspaceMover\third-party\glm-0.9.9-a2
  # TODO: Should add `branch=master` but it isn't on master yet.
  - appveyor DownloadFile "https://ci.appveyor.com/api/projects/trejkaz/OpenVR-InputEmulator/artifacts/LibVRInputEmulator-%CONFIGURATION%.zip?job=Configuration%%%%3A+%CONFIGURATION%"
  - 7z x LibVRInputEmulator-%CONFIGURATION%.zip -oPlayspaceMover\third-party\VRInputEmulator -r

build_script:
  - msbuild /P:Configuration=%CONFIGURATION% /P:Platform=%PLATFORM% PlayspaceMover.sln
  - dir /s PlayspaceMover\

#artifacts:
#  - path: code_pages.exe
#  - path: code_pages_result.log
